<%- include('../layout', { body: `
<div class="max-w-6xl mx-auto">
  <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
    <div class="flex justify-end items-center mb-6">
      <a href="/cortes" class="text-primary-500 hover:text-primary-600">
        <i class="fas fa-arrow-left mr-2"></i>Volver
      </a>
    </div>

    ${success ? '<div class="mb-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded">' + success + '</div>' : ''}

    ${error ? '<div class="mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">' + error + '</div>' : ''}

    <div class="mb-6">
      <form method="GET" action="/cortes/historial" class="flex gap-2">
        <input type="date" name="fecha" value="${fecha}" class="px-4 py-2 border rounded-lg">
        <button type="submit" class="bg-primary-500 hover:bg-primary-600 text-white px-6 py-2 rounded-lg">
          <i class="fas fa-search mr-2"></i>Buscar
        </button>
        <a href="/cortes/historial" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg">
          <i class="fas fa-redo mr-2"></i>Limpiar
        </a>
      </form>
    </div>

    <div class="overflow-x-auto">
      <table class="w-full">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Fecha</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Hora</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Total Ventas</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Saldo Final</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Diferencia</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Usuario</th>
            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Acciones</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          ${cortes && cortes.length > 0 ? cortes.map(corte => 
            '<tr class="hover:bg-gray-50">' +
              '<td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">' + moment(corte.fecha).format('DD/MM/YYYY') + '</td>' +
              '<td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">' + (corte.hora || 'Saldo Inicial') + '</td>' +
              '<td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">' + formatCurrency(parseFloat(corte.totalVentas)) + '</td>' +
              '<td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">' + formatCurrency(parseFloat(corte.saldoFinal)) + '</td>' +
              '<td class="px-4 py-3 whitespace-nowrap text-sm font-medium ' + (parseFloat(corte.diferencia) < 0 ? 'text-red-600' : 'text-green-600') + '">' + formatCurrency(parseFloat(corte.diferencia)) + '</td>' +
              '<td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">' + (corte.usuario ? corte.usuario.nombre : 'N/A') + '</td>' +
              '<td class="px-4 py-3 whitespace-nowrap text-sm">' +
                '<a href="/cortes/' + corte.id + '" class="text-primary-500 hover:text-primary-600 mr-3"><i class="fas fa-eye"></i></a>' +
                '<a href="/cortes/' + corte.id + '/reporte" class="text-red-500 hover:text-red-600" target="_blank"><i class="fas fa-file-pdf"></i></a>' +
              '</td>' +
            '</tr>'
          ).join('') : '<tr><td colspan="7" class="px-4 py-8 text-center text-gray-500">No se encontraron cortes para la fecha seleccionada</td></tr>'}
        </tbody>
      </table>
    </div>
  </div>
</div>
` }) %>
