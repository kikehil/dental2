<%- include('../layout', { body: `
<div class="mb-6">
  <form action="/pacientes" method="GET" class="flex gap-2">
    <input type="text" name="search" value="${search}" placeholder="Buscar paciente..." 
      class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 w-full md:w-64">
    <button type="submit" class="bg-gray-100 text-gray-600 px-4 py-2 rounded-lg hover:bg-gray-200 transition">
      <i class="fas fa-search"></i>
    </button>
  </form>
</div>

<div class="bg-white rounded-xl shadow-sm overflow-hidden">
  <div class="overflow-x-auto">
    <table class="w-full">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-4 text-left text-sm font-medium text-gray-600">Paciente</th>
          <th class="px-6 py-4 text-left text-sm font-medium text-gray-600">Edad</th>
          <th class="px-6 py-4 text-left text-sm font-medium text-gray-600">Teléfono</th>
          <th class="px-6 py-4 text-left text-sm font-medium text-gray-600">Email</th>
          <th class="px-6 py-4 text-center text-sm font-medium text-gray-600">Acciones</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-100">
        ${pacientes.length > 0 ? pacientes.map(p => '<tr class="hover:bg-gray-50">' +
          '<td class="px-6 py-4">' +
            '<div class="flex items-center gap-3">' +
              '<div class="w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center text-primary-600 font-bold">' + p.nombre[0] + p.apellido[0] + '</div>' +
              '<div>' +
                '<p class="font-medium text-gray-800">' + p.nombre + ' ' + p.apellido + '</p>' +
                '<p class="text-sm text-gray-500">' + (p.genero || '') + '</p>' +
              '</div>' +
            '</div>' +
          '</td>' +
          '<td class="px-6 py-4 text-gray-600">' + (calculateAge(p.fechaNacimiento) ? calculateAge(p.fechaNacimiento) + ' años' : '-') + '</td>' +
          '<td class="px-6 py-4 text-gray-600">' + (p.telefono || '-') + '</td>' +
          '<td class="px-6 py-4 text-gray-600">' + (p.email || '-') + '</td>' +
          '<td class="px-6 py-4 text-center">' +
            '<a href="/pacientes/' + p.id + '" class="text-primary-600 hover:text-primary-800 mx-1" title="Ver"><i class="fas fa-eye"></i></a>' +
            '<a href="/pacientes/' + p.id + '/editar" class="text-gray-600 hover:text-gray-800 mx-1" title="Editar"><i class="fas fa-edit"></i></a>' +
            '<form action="/pacientes/' + p.id + '/eliminar" method="POST" class="inline-block mx-1" onsubmit="return confirm(\'¿Está seguro de desactivar este paciente?\')">' +
              '<button type="submit" class="text-yellow-600 hover:text-yellow-800" title="Desactivar"><i class="fas fa-ban"></i></button>' +
            '</form>' +
            '<form action="/pacientes/' + p.id + '/eliminar-permanente" method="POST" class="inline-block mx-1" onsubmit="return confirm(\'¿Está SEGURO de eliminar PERMANENTEMENTE este paciente? Esta acción NO se puede deshacer.\')">' +
              '<button type="submit" class="text-red-600 hover:text-red-800" title="Eliminar Permanentemente"><i class="fas fa-trash-alt"></i></button>' +
            '</form>' +
          '</td>' +
        '</tr>').join('') : '<tr><td colspan="5" class="px-6 py-8 text-center text-gray-500">No se encontraron pacientes</td></tr>'}
      </tbody>
    </table>
  </div>
</div>
`}) %>

